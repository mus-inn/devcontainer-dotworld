#!/usr/bin/env bash

set -euo pipefail

if [ ! -d /.composer ]; then
    mkdir /.composer
fi

chmod -R ugo+rw /.composer || true

# Allow binding to privileged ports when run as non-root (if capability is set)
setcap -v cap_net_bind_service+ep /usr/local/bin/frankenphp || true

# Default SERVER_NAME: hostname and bind on :80 and :443 (HTTP/3 enabled by image)
: "${SERVER_NAME:=localhost, :80, :443}"

exec frankenphp run
